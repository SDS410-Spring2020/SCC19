---
title: "Results"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    df_print: kable
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup,  message=FALSE, warning=FALSE, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, warning = FALSE, fig.width = 16/2, fig.height = 9/2
)
```

## Results

```{r} 
#starter code :)
#loading libraries
library(tidytext)
library(stringr)
library(tidyverse)
library(wordcloud)
library(dplyr)
library(reshape2)
library(lubridate)
library(ggplot2)

#load the rda file
load(file = "textdata.Rda")

#code to get started
#"pasted this part from Emily :), original code by Jeny :)"
df_tidy <- df_full %>% 
  unnest_tokens(word, content) %>% 
  anti_join(stop_words) 
```


## Negative Sentiment of 2020 Emails 

```{r}
#calls for bing sentiment lexicon 
bing_lex = get_sentiments("bing")

#each year splits into groups of 50 words (we can vary this)
#sentiment score is calculated
bing_score <- df_tidy %>%
  mutate(year = year(date)) %>%
  group_by(year) %>% 
  mutate(word_count = 1:n(),
         index = word_count %/% 50 + 1) %>% 
  inner_join(bing_lex, by = "word") %>%
  count(year, index = index , sentiment) %>%
  ungroup() %>%
  spread(sentiment, n, fill = 0) %>%
  mutate(sentiment = positive - negative,
         date = factor(year)) %>%
  ggplot(aes(index, sentiment, fill = year)) +
  geom_bar(alpha = 0.5, stat = "identity", show.legend = FALSE) +
  facet_wrap(~ date, ncol = 2, scales = "free_x")
bing_score
```


## Visualization 2


## Visualization 3